# Example: Vulnerability Audit

## Prompt

```
Check R1 for known CVE vulnerabilities
```

## What NetClaw Does

NetClaw combines **pyats-network** (to get the software version) with **nvd-cve** (to search the NVD database):

### Step 1: Get Software Version

```
→ pyats_run_show_command: show version
```

Extracts the IOS-XE version (e.g., `17.09.04a`) and platform (C8000V).

### Step 2: Search NVD for CVEs

```
→ nvd-cve search_cves: keyword "IOS-XE 17.9"
```

Returns a list of CVEs matching the software version.

### Step 3: Get Details for Each CVE

For each CVE found:

```
→ nvd-cve get_cve_details: cve_id "CVE-2023-20198"
→ nvd-cve get_cve_details: cve_id "CVE-2023-20273"
→ nvd-cve get_cve_details: cve_id "CVE-2024-20353"
```

Retrieves full details: CVSS score, affected products, description, remediation.

### Step 4: Classify and Report

NetClaw classifies each CVE by CVSS severity:
- Critical (9.0-10.0)
- High (7.0-8.9)
- Medium (4.0-6.9)
- Low (0.1-3.9)

## Example Output

```
Vulnerability Audit: R1
Platform: C8000V | IOS-XE: 17.9.4a
Scan Date: 2025-02-19

CRITICAL (CVSS >= 9.0):
  CVE-2023-20198 (CVSS 10.0)
    Cisco IOS XE Web UI Privilege Escalation
    Affected: IOS-XE with HTTP/HTTPS server enabled
    Fix: Upgrade to 17.9.4a or later, disable ip http server
    Status: Check if 'ip http server' is in running config

  CVE-2023-20273 (CVSS 9.8)
    Cisco IOS XE Web UI Command Injection
    Affected: IOS-XE with HTTP/HTTPS server enabled
    Fix: Upgrade to 17.9.4a or later
    Status: Related to CVE-2023-20198, same mitigation

HIGH (CVSS 7.0-8.9):
  CVE-2024-20353 (CVSS 8.6)
    Cisco IOS XE Software Web Management DoS
    Affected: IOS-XE web management interface
    Fix: Upgrade to fixed release

Summary: 2 Critical | 1 High | 0 Medium | 0 Low

Recommendations:
  1. Verify 'no ip http server' is configured (mitigates web UI CVEs)
  2. Plan upgrade to latest IOS-XE maintenance release
  3. Apply ACL to restrict management access (VTY + HTTP)
```

### Step 5: Cross-Reference with Running Config

NetClaw then checks if the device is actually exposed:

```
→ pyats_show_running_config
```

Scans for `ip http server` / `ip http secure-server` to determine if the web UI CVEs are exploitable on this device.

## Skills Used

- **pyats-network** (show version, running config)
- **nvd-cve** (CVE search and details)
- **pyats-security** (config analysis for exposure assessment)
